---
import { Zoom } from 'starlight-image-zoom/components';
import { Image } from 'astro:assets';

interface ImageProps {
  src: string;
  alt: string;
  caption?: string;
  style?: string;
}

const { src, alt, caption, style } = Astro.props;

const images = import.meta.glob('../assets/diagrams/*.svg', { eager: true }) as Record<string, { default: ImageMetadata }>;

const path = `../assets/diagrams/${src}`;
const image = images[path]?.default;

if (!image) {
  console.error('Available images:', Object.keys(images));
  throw new Error(`Image not found: ${src}. Looking for: ${path}`);
}
---

<figure style="display: flex; flex-direction: column; justify-content: center; margin: 2rem 0;">
  <Zoom label={alt}>
    <Image src={image} alt={alt} loading="lazy" style=`width: 100%;${style}` />
  </Zoom>
  <h4>{caption}</h4>
</figure>